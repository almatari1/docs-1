<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1770px" preserveAspectRatio="none" style="width:1256px;height:1770px;" version="1.1" viewBox="0 0 1256 1770" width="1256px" zoomAndPan="magnify"><defs><filter height="300%" id="f7j32v4a2viu8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="398" x="430" y="22.9951">1.3.0. Position Handler Consume (single message)</text><rect fill="#FFFFE0" height="1724.7109" style="stroke: #A80036; stroke-width: 1.0;" width="1200" x="29" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="573.5" y="46.3638">Central Service</text><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="115" y="181.125"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="115" y="688.9219"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="115" y="1196.7188"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="1585.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="439" y="111.7266"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="1571.9844" style="stroke: #000000; stroke-width: 2.0;" width="1232" x="13" y="118.7266"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="1540.8516" style="stroke: #000000; stroke-width: 2.0;" width="1212" x="23" y="142.8594"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="535" x="365" y="226.125"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="515" x="375" y="250.2578"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="577" x="375" y="345.6563"/><rect fill="#FFFFFF" height="507.7969" style="stroke: none; stroke-width: 1.0;" width="1212" x="23" y="652.9844"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="534" x="365" y="733.9219"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="514" x="375" y="758.0547"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="577" x="375" y="853.4531"/><rect fill="#FFFFFF" height="522.9297" style="stroke: none; stroke-width: 1.0;" width="1212" x="23" y="1160.7813"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="120.6641" style="stroke: #000000; stroke-width: 2.0;" width="415" x="365" y="1241.7188"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="89.5313" style="stroke: #000000; stroke-width: 2.0;" width="395" x="375" y="1265.8516"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="577" x="375" y="1376.3828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="120" x2="120" y1="101.7266" y2="1707.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="444" x2="444" y1="101.7266" y2="1707.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="890" x2="890" y1="101.7266" y2="1707.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1013" x2="1013" y1="101.7266" y2="1707.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1154" x2="1154" y1="101.7266" y2="1707.7109"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="37" y="62.4297"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="33" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="40" y="86.4248">topic-transfer-position</text><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="37" y="1706.7109"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="33" y="1710.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="40" y="1730.7061">topic-transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="385" y="98.4248">Position Handler</text><ellipse cx="444" cy="69.4297" fill="#FEFECE" filter="url(#f7j32v4a2viu8)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="440,57.4297,446,52.4297,444,57.4297,446,62.4297,440,57.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="385" y="1719.7061">Position Handler</text><ellipse cx="444" cy="1739.0078" fill="#FEFECE" filter="url(#f7j32v4a2viu8)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="440,1727.0078,446,1722.0078,444,1727.0078,446,1732.0078,440,1727.0078" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="842" y="62.4297"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="838" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="845" y="86.4248">Event-Topic</text><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="842" y="1706.7109"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="838" y="1710.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="845" y="1730.7061">Event-Topic</text><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="956" y="62.4297"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="952" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="959" y="86.4248">Transfer-Topic</text><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="956" y="1706.7109"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="952" y="1710.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="959" y="1730.7061">Transfer-Topic</text><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="1088" y="62.4297"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="1084" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1091" y="86.4248">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="1088" y="1706.7109"/><rect fill="#FEFECE" filter="url(#f7j32v4a2viu8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="1084" y="1710.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1091" y="1730.7061">Notification-Topic</text><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="115" y="181.125"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="115" y="688.9219"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="115" y="1196.7188"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="1585.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="439" y="111.7266"/><path d="M13,118.7266 L253,118.7266 L253,125.7266 L243,135.7266 L13,135.7266 L13,118.7266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1571.9844" style="stroke: #000000; stroke-width: 2.0;" width="1232" x="13" y="118.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="195" x="28" y="131.7935">Position Handler Consume</text><path d="M23,142.8594 L87,142.8594 L87,149.8594 L77,159.8594 L23,159.8594 L23,142.8594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1540.8516" style="stroke: #000000; stroke-width: 2.0;" width="1212" x="23" y="142.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="155.9263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="246" x="102" y="155.0698">[Consume Prepare message for Payer]</text><polygon fill="#A80036" points="136,177.125,126,181.125,136,185.125,132,181.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="130" x2="438" y1="181.125" y2="181.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="142" y="176.0591">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="155" y="176.0591">Consume Position event message for Payer</text><path d="M365,226.125 L453,226.125 L453,233.125 L443,243.125 L365,243.125 L365,226.125 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="535" x="365" y="226.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="380" y="239.1919">break</text><path d="M375,250.2578 L527,250.2578 L527,257.2578 L517,267.2578 L375,267.2578 L375,250.2578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="515" x="375" y="250.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="390" y="263.3247">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="491" y1="303.6563" y2="303.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="491" x2="491" y1="303.6563" y2="316.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="450" x2="491" y1="316.6563" y2="316.6563"/><polygon fill="#A80036" points="460,312.6563,450,316.6563,460,320.6563,456,316.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="456" y="291.0239">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="409" x="469" y="283.4575">Validate event - Rule: type == 'position' &amp;&amp; action == 'prepare'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="469" y="298.5903">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="563" y="298.5903">2001</text><path d="M375,345.6563 L607,345.6563 L607,352.6563 L597,362.6563 L375,362.6563 L375,345.6563 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="577" x="375" y="345.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="390" y="358.7231">Persist Event Information</text><polygon fill="#A80036" points="878,404.9219,888,408.9219,878,412.9219,882,408.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="884" y1="408.9219" y2="408.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="456" y="403.856">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="469" y="403.856">Publish event information</text><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="559" x="382" y="416.9219"/><polygon fill="#EEEEEE" points="382,416.9219,448,416.9219,448,423.9219,438,433.9219,382,433.9219,382,416.9219" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="395" y="430.9888">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="556" y="449.9888">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="723" y="449.9888">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="723" x2="759" y1="451.9888" y2="451.9888"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="759" y="449.9888">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="560" y="465.1216"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="342" x="382" y="534.3203"/><polygon fill="#EEEEEE" points="382,534.3203,448,534.3203,448,541.3203,438,551.3203,382,551.3203,382,534.3203" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="395" y="548.3872">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="388" y="567.3872">Prepare Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="87" x="623" y="567.3872">1.3.1-prepare</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="623" x2="710" y1="569.3872" y2="569.3872"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="710" y="567.3872">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="392" y="582.52"/><polygon fill="#A80036" points="1001,611.8516,1011,615.8516,1001,619.8516,1005,615.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="1007" y1="615.8516" y2="615.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="456" y="610.7856">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="469" y="610.7856">Produce message</text><polygon fill="#A80036" points="1142.5,640.9844,1152.5,644.9844,1142.5,648.9844,1146.5,644.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="1148.5" y1="644.9844" y2="644.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="456" y="639.9185">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="469" y="639.9185">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1235" y1="653.9844" y2="653.9844"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="28" y="664.1948">[Consume Fulfil message for Payee]</text><polygon fill="#A80036" points="136,684.9219,126,688.9219,136,692.9219,132,688.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="130" x2="438" y1="688.9219" y2="688.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="142" y="683.856">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="282" x="155" y="683.856">Consume Position event message for Payee</text><path d="M365,733.9219 L453,733.9219 L453,740.9219 L443,750.9219 L365,750.9219 L365,733.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="534" x="365" y="733.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="380" y="746.9888">break</text><path d="M375,758.0547 L527,758.0547 L527,765.0547 L517,775.0547 L375,775.0547 L375,758.0547 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="514" x="375" y="758.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="390" y="771.1216">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="491" y1="811.4531" y2="811.4531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="491" x2="491" y1="811.4531" y2="824.4531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="450" x2="491" y1="824.4531" y2="824.4531"/><polygon fill="#A80036" points="460,820.4531,450,824.4531,460,828.4531,456,824.4531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="456" y="798.8208">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="408" x="469" y="791.2544">Validate event - Rule: type == 'position' &amp;&amp; action == 'commit'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="469" y="806.3872">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="563" y="806.3872">2001</text><path d="M375,853.4531 L607,853.4531 L607,860.4531 L597,870.4531 L375,870.4531 L375,853.4531 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="577" x="375" y="853.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="390" y="866.52">Persist Event Information</text><polygon fill="#A80036" points="878,912.7188,888,916.7188,878,920.7188,882,916.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="884" y1="916.7188" y2="916.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="456" y="911.6528">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="469" y="911.6528">Publish event information</text><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="559" x="382" y="924.7188"/><polygon fill="#EEEEEE" points="382,924.7188,448,924.7188,448,931.7188,438,941.7188,382,941.7188,382,924.7188" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="395" y="938.7856">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="556" y="957.7856">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="723" y="957.7856">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="723" x2="759" y1="959.7856" y2="959.7856"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="759" y="957.7856">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="560" y="972.9185"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="295" x="382" y="1042.1172"/><polygon fill="#EEEEEE" points="382,1042.1172,448,1042.1172,448,1049.1172,438,1059.1172,382,1059.1172,382,1042.1172" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="395" y="1056.1841">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="388" y="1075.1841">Fulfil Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="62" x="601" y="1075.1841">1.3.2-fulfil</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="601" x2="663" y1="1077.1841" y2="1077.1841"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="663" y="1075.1841">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="392" y="1090.3169"/><polygon fill="#A80036" points="1001,1119.6484,1011,1123.6484,1001,1127.6484,1005,1123.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="1007" y1="1123.6484" y2="1123.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="456" y="1118.5825">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="469" y="1118.5825">Produce message</text><polygon fill="#A80036" points="1142.5,1148.7813,1152.5,1152.7813,1142.5,1156.7813,1146.5,1152.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="1148.5" y1="1152.7813" y2="1152.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="456" y="1147.7153">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="478" y="1147.7153">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1235" y1="1161.7813" y2="1161.7813"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="28" y="1171.9917">[Consume Abort message]</text><polygon fill="#A80036" points="136,1192.7188,126,1196.7188,136,1200.7188,132,1196.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="130" x2="438" y1="1196.7188" y2="1196.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="142" y="1191.6528">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="164" y="1191.6528">Consume Position event message</text><path d="M365,1241.7188 L453,1241.7188 L453,1248.7188 L443,1258.7188 L365,1258.7188 L365,1241.7188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="120.6641" style="stroke: #000000; stroke-width: 2.0;" width="415" x="365" y="1241.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="380" y="1254.7856">break</text><path d="M375,1265.8516 L527,1265.8516 L527,1272.8516 L517,1282.8516 L375,1282.8516 L375,1265.8516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="89.5313" style="stroke: #000000; stroke-width: 2.0;" width="395" x="375" y="1265.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="390" y="1278.9185">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="491" y1="1334.3828" y2="1334.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="491" x2="491" y1="1334.3828" y2="1347.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="450" x2="491" y1="1347.3828" y2="1347.3828"/><polygon fill="#A80036" points="460,1343.3828,450,1347.3828,460,1351.3828,456,1347.3828" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="456" y="1314.1841">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="478" y="1299.0513">Validate event - Rule: type == 'position' &amp;&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="478" y="1314.1841">action IN ['timeout-reserved', 'reject', 'fail']</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="478" y="1329.3169">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="572" y="1329.3169">2001</text><path d="M375,1376.3828 L607,1376.3828 L607,1383.3828 L597,1393.3828 L375,1393.3828 L375,1376.3828 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="577" x="375" y="1376.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="390" y="1389.4497">Persist Event Information</text><polygon fill="#A80036" points="878,1435.6484,888,1439.6484,878,1443.6484,882,1439.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="884" y1="1439.6484" y2="1439.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="456" y="1434.5825">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="478" y="1434.5825">Publish event information</text><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="559" x="382" y="1447.6484"/><polygon fill="#EEEEEE" points="382,1447.6484,448,1447.6484,448,1454.6484,438,1464.6484,382,1464.6484,382,1447.6484" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="395" y="1461.7153">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="556" y="1480.7153">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="723" y="1480.7153">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="723" x2="759" y1="1482.7153" y2="1482.7153"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="759" y="1480.7153">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="560" y="1495.8481"/><rect fill="#FFFFFF" filter="url(#f7j32v4a2viu8)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="311" x="382" y="1565.0469"/><polygon fill="#EEEEEE" points="382,1565.0469,448,1565.0469,448,1572.0469,438,1582.0469,382,1582.0469,382,1565.0469" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="395" y="1579.1138">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="388" y="1598.1138">Abort Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="71" x="608" y="1598.1138">1.3.3-abort</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="608" x2="679" y1="1600.1138" y2="1600.1138"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="679" y="1598.1138">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="392" y="1613.2466"/><polygon fill="#A80036" points="1001,1642.5781,1011,1646.5781,1001,1650.5781,1005,1646.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="1007" y1="1646.5781" y2="1646.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="456" y="1641.5122">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="478" y="1641.5122">Produce message</text><polygon fill="#A80036" points="1142.5,1671.7109,1152.5,1675.7109,1142.5,1679.7109,1146.5,1675.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="1148.5" y1="1675.7109" y2="1675.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="456" y="1670.645">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="478" y="1670.645">Produce message</text><!--
@startuml
title 1.3.0. Position Handler Consume (single message)

autonumber


collections "topic-transfer-position" as TOPIC_TRANSFER_POSITION
control "Position Handler" as POS_HANDLER
collections "Transfer-Topic" as TOPIC_TRANSFERS
collections "Event-Topic" as TOPIC_EVENTS
collections "Notification-Topic" as TOPIC_NOTIFICATIONS

box "Central Service" #LightYellow
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_EVENTS
    participant TOPIC_TRANSFERS
    participant TOPIC_NOTIFICATIONS
end box

activate POS_HANDLER
group Position Handler Consume
    alt Consume Prepare message for Payer
        TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume Position event message for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' && action == 'prepare'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Prepare Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg 1.3.1-prepare]]} \n
        POS_HANDLER -> TOPIC_TRANSFERS: Produce message
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Fulfil message for Payee
        TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume Position event message for Payee
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' && action == 'commit'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Fulfil Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg 1.3.2-fulfil]]} \n
        POS_HANDLER -> TOPIC_TRANSFERS: Produce message
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Abort message
        TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume Position event message
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' &&\naction IN ['timeout-reserved', 'reject', 'fail']\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Abort Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg 1.3.3-abort]]} \n
        POS_HANDLER -> TOPIC_TRANSFERS: Produce message
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    end

end
deactivate POS_HANDLER
@enduml

PlantUML version 1.2018.12(Sun Oct 21 05:15:15 CDT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_191-8u191-b12-0ubuntu0.16.04.1-b12
Operating System: Linux
OS Version: 4.4.0-31-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>